<div class="user_auth">
    <div class="user_auth__action">
        <button #signInButton (click)="changeAction(true)" (mouseenter)="setupHover(signInButton, signUpButton)"
            (mouseleave)="setupUnhover(signInButton, signUpButton)"
            [ngClass]="{'user_auth__action_button--active': isInLoginView}" class="user_auth__action_button">Sign
            in</button>
        <button #signUpButton (click)="changeAction(false)" (mouseenter)="setupHover(signUpButton, signInButton)"
            (mouseleave)="setupUnhover(signUpButton, signInButton)"
            [ngClass]="{'user_auth__action_button--active': !isInLoginView}" class="user_auth__action_button">Sign
            up</button>
    </div>
    @if(isInLoginView) {
    <form [formGroup]="loginForm" (ngSubmit)="doAction(loginForm)" class="user_auth__form">
        <div class="user_auth__controls_wrapper">
            <label for="username-or-email" class="user_auth__label">
                Username or email:
            </label>
            <input formControlName="usernameOrEmail" id="username-or-email" type="text" placeholder="Username or email"
                class="user_auth__input">
            @if (loginForm.controls.usernameOrEmail.touched) {
            @for (error of formErrors(loginForm.controls.usernameOrEmail, "Username/email"); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
            }
        </div>
        <div class="user_auth__controls_wrapper">
            <label for="password" class="user_auth__label">Password:</label>
            <input formControlName="password" id="password" type="password" placeholder="*****"
                class="user_auth__input">
            @if (loginForm.controls.password.touched) {
            @for (error of formErrors(loginForm.controls.password, "Password"); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
            }
        </div>
        <div class="user_auth__controls_wrapper">
            <button [ngClass]="loginForm.valid || !loginForm.touched ? '' : 'user_auth__button--error' "
                class="user_auth__button" type="submit">Submit</button>
        </div>
        <div class="user_auth__controls_wrapper">
            @for (error of errors(); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
        </div>
    </form>
    } @else {
    <form [formGroup]="registerForm" (ngSubmit)="doAction(registerForm)" class="user_auth__form">
        <div class="user_auth__controls_wrapper">
            <label for="username" class="user_auth__label">
                Username:
            </label>
            <input formControlName="username" id="username" type="text" placeholder="Username" class="user_auth__input">
            @if (registerForm.controls.username.touched) {
            @for (error of formErrors(registerForm.controls.username, "Username", 4, 100); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
            }
        </div>
        <div class="user_auth__controls_wrapper">
            <label for="email" class="user_auth__label">Email:</label>
            <input formControlName="email" id="email" type="email" placeholder="Email" class="user_auth__input">
            @if (registerForm.controls.email.touched) {
            @for (error of formErrors(registerForm.controls.email, "Email"); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
            }
        </div>
        <div class="user_auth__controls_wrapper">
            <label for="password" class="user_auth__label">Password:</label>
            <input formControlName="password" id="password" type="password" placeholder="*****"
                class="user_auth__input">
            @if (registerForm.controls.password.touched) {
            @for (error of formErrors(registerForm.controls.password, "Password"); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
            }
        </div>
        <div class="user_auth__controls_wrapper">
            <label for="matching-password" class="user_auth__label">Repeat password:</label>
            <input formControlName="matchingPassword" id="matching-password" placeholder="*****" type="password"
                class="user_auth__input">
            @if (registerForm.controls.matchingPassword.touched) {
            @for (error of formErrors(registerForm.controls.matchingPassword, "Password"); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
            }
        </div>
        <div class="user_auth__controls_wrapper">
            <button [ngClass]="registerForm.valid || !registerForm.touched ? '' : 'user_auth__button--error' "
                class="user_auth__button" type="submit">Submit</button>
        </div>
        <div class="user_auth__controls_wrapper">
            @for (error of errors(); track $index) {
            <p class="user_auth__error">{{error}}</p>
            }
        </div>
    </form>
    }
</div>